DROP TABLE IF EXISTS documents CASCADE;
CREATE TABLE documents (
    id bigserial PRIMARY KEY NOT NULL,
    number NUMERIC(9) NOT NULL,
    date_time TIMESTAMP NOT NULL,
    sum FLOAT NOT NULL,
    card_id bigserial NOT NULL,
    FOREIGN KEY (card_id) REFERENCES cards (id)
);
INSERT INTO documents (id, number, date_time, sum, card_id) VALUES
    (1, 10001, '2021-11-01 10:05:06', 999.90, 1),
    (14, 10014, '2021-11-02 11:05:06', 1250, 2),
    (28, 10028, '2021-11-03 12:05:06', 1720.80, 3),
    (34, 10034, '2021-11-12 13:05:06', 99, 1),
    (48, 10048, '2021-11-12 14:05:06', 150.70, 2),
    (91, 10091, '2021-11-06 15:05:06', 2550, 3),
    (99, 10099, '2021-11-07 16:05:06', 159.90, 1),
    (118, 10118, '2021-12-09 10:00:33', 362.90, 2),
    (134, 10134, '2021-12-09 12:15:06', 1400, 3),
    (184, 10184, '2021-12-15 11:05:06', 159.90, 1),
    (211, 10211, '2021-12-15 15:11:30', 1674.20, 3),
    (282, 10282, '2021-12-16 19:15:06', 3274.50, 3),
    (294, 10294, '2021-12-16 20:05:00', 109.90, 1),
    (314, 10314, '2021-12-17 10:10:00', 759, 3),
    (510, 10510, '2021-12-19 20:05:06', 411.70, 2),
    (731, 10731, '2021-12-25 10:10:00', 2759.80, 3),
    (1231, 11231, '2022-01-02 19:22:00', 1490.10, 2),
    (1319, 11319, '2022-02-02 11:10:00', 245.90, 1),
    (1441, 11441, '2022-02-05 12:30:00', 745.70, 1),
    (1400, 11400, '2022-02-04 19:25:06', 2500, 3),
    (1425, 11425, '2022-02-05 10:44:00', 1520, 3),
    (1444, 11444, '2022-02-12 18:05:06', 101.70, 2),
    (1478, 11478, '2022-03-13 13:01:03', 99.90, 2),
    (1499, 11499, '2022-03-14 16:07:16', 500, 2),
    (1520, 11520, '2022-03-15 11:05:06', 1559.90, 1),
    (1561, 11561, '2022-03-20 19:55:06', 2520, 3),
    (1599, 11599, '2022-03-21 09:09:09', 1000, 3);

DROP TABLE counters CASCADE;
CREATE TABLE counters (
    id bigserial PRIMARY KEY,
    card_id bigint REFERENCES cards(id),
    delta FLOAT NOT NULL,
    delta_date_time timestamp NOT NULL,
    active_date DATE,
    document_id bigserial NOT NULL,
    FOREIGN KEY (document_id) REFERENCES documents (id)
);
INSERT INTO counters (card_id, delta, delta_date_time, active_date, document_id) VALUES
    (1, 10, '2021-11-01 10:05:06', '2021-11-11', 1),
    (2, 15, '2021-11-02 11:05:06', '2021-11-12', 14),
    (3, 20, '2021-11-03 12:05:06', '2021-11-13', 28),
    (1, 1, '2021-11-12 13:05:06', '2021-11-22', 34),
    (2, 3, '2021-11-12 14:05:06', '2021-11-22', 48),
    (3, 40, '2021-11-06 15:05:06', '2021-11-16', 91),
    (1, 5.5, '2021-11-07 16:05:06', '2021-11-17', 99),
    (2, 10, '2021-12-09 10:00:33', '2021-12-19', 118),
    (3, 20, '2021-12-09 12:15:06', '2021-12-19', 134),
    (1, 4.5, '2021-12-15 11:05:06', '2021-12-25', 184),
    (3, 20.9, '2021-12-15 15:11:30', '2021-12-25', 211),
    (3, 40.1, '2021-12-16 19:15:06', '2021-12-26', 282);
INSERT INTO counters (card_id, delta, delta_date_time, document_id) VALUES
    (2, -15, '2021-11-12 14:05:06', 48),
    (1, -5, '2021-12-16 20:05:00', 294);
INSERT INTO counters (card_id, delta, delta_date_time, active_date, document_id) VALUES
    (1, 0.5, '2021-12-16 20:05:00', '2021-12-26', 294),
    (3, 15.5, '2021-12-17 10:10:00', '2021-12-27', 314);
INSERT INTO counters (card_id, delta, delta_date_time, document_id) VALUES
    (3, -50, '2021-12-17 10:10:00', 314),
    (2, -10, '2021-12-19 20:05:06', 510);
INSERT INTO counters (card_id, delta, delta_date_time, active_date, document_id) VALUES
    (2, 2.8, '2021-12-19 20:05:06', '2021-12-29', 510),
    (3, 30, '2021-12-25 10:10:00', '2021-12-04', 731),
    (2, 5.9, '2022-01-02 19:22:00', '2022-01-12', 1231),
    (1, 8, '2022-02-02 11:10:00', '2022-01-12', 1319),
    (1, 11, '2022-02-05 12:30:00', '2022-01-15', 1441),
    (3, 15, '2022-02-04 19:25:06', '2022-03-14', 1400),
    (3, 21.2, '2022-02-05 10:44:00', '2022-03-15', 1425),
    (2, 0.9, '2022-02-12 18:05:06', '2022-03-22', 1444);
INSERT INTO counters (card_id, delta, delta_date_time, document_id) VALUES
(2, -5.9, '2022-02-12   18:05:06', 1444);
INSERT INTO counters (card_id, delta, delta_date_time, active_date, document_id) VALUES
    (2, 2, '2022-03-13 13:01:03', '2022-03-23', 1478),
    (2, 9, '2022-03-14 16:07:16', '2022-03-24', 1499),
    (1, 18, '2022-03-15 11:05:06', '2022-03-25', 1520),
    (3, 25, '2022-03-20 19:55:06', '2022-03-30', 1561),
    (3, 14.3, '2022-03-21 09:09:09', '2022-03-31', 1599);